# PRD文档编写规范

本文档旨在统一产品需求文档（PRD）的编写格式与内容规范，确保需求描述的清晰性、完整性及可落地性，降低沟通成本，提升开发效率。所有新功能或迭代需求均需遵循此规范。

## 一、 文档结构规范

一份完整的 PRD 文档应包含以下核心章节：

### 1. 文档基础信息 (Document Info)
*   **文档标题**：清晰简练，包含项目名称或功能模块（如：商品分销系统-采购模块PRD）。
*   **版本记录**：
    *   版本号 (v1.0.0)
    *   修订日期 (YYYY-MM-DD)
    *   修改人
    *   修改内容摘要（新增/修改/删除）
*   **项目背景与目标**：
    *   **背景**：为什么要做这个功能？解决什么痛点？
    *   **目标**：期望达到的业务效果或用户价值。
    *   **范围**：本次迭代包含什么，不包含什么（Scope）。

### 2. 角色与流程 (Roles & Workflows)
*   **用户角色**：列出涉及的所有用户类型（如：品牌方、代理商、系统管理员）。
*   **业务流程图**：必须提供核心业务流程图（Flowchart），展示用户操作路径和系统判断逻辑。
    *   工具建议：Mermaid, ProcessOn, Visio。
    *   规范：明确开始/结束节点、判断条件、正常/异常路径。

### 3. 功能需求详情 (Functional Requirements)
这是 PRD 的**核心部分**，需按模块拆分，每个功能点包含：
*   **功能名称**：如“商品添加”。
*   **用户故事 (User Story)**：
    *   **格式**：作为 [角色]，我想要 [功能]，以便于 [价值]。
    *   **示例**：作为品牌方，我想要批量导入商品，以便于快速上架新品。
*   **前置条件**：如“用户已登录且具有品牌方权限”。
*   **页面/入口**：功能在系统中的位置。
*   **界面原型/草图**：
    *   描述页面布局（搜索区、列表区、操作区）。
    *   提供字段级定义（字段名、类型、长度、默认值、校验规则）。
*   **操作交互**：
    *   点击某按钮后的反馈（弹窗、跳转、Toast提示）。
    *   异常情况处理（网络失败、校验不通过）。
*   **后端逻辑要求**：
    *   数据流向（写入哪些表）。
    *   关键计算逻辑（如：总价 = 单价 * 数量）。
    *   关联影响（如：库存扣减）。
*   **验收标准 (Acceptance Criteria)**：
    *   **Given** (前置)：用户在商品列表页。
    *   **When** (操作)：点击“上架”按钮。
    *   **Then** (结果)：商品状态变更为“已上架”，且前端显示成功提示。

### 4. 非功能需求 (Non-functional Requirements)
*   **性能要求**：响应时间、并发量、数据量支持。
*   **安全要求**：权限控制、数据加密、敏感信息脱敏。
*   **数据统计**：是否需要埋点，统计哪些指标。
*   **兼容性**：支持的浏览器、分辨率、设备类型。

### 5. 数据字典与附录 (Data Dictionary & Appendix)
*   **核心数据模型**：简述涉及的关键实体及其关系（ER图）。
*   **枚举值定义**：状态流转定义（如：订单状态机）。
*   **全局规则**：通用的交互规则、异常提示规范。

---

## 二、 详细编写指南 (基于现有需求文档优化)

### 1. 字段定义表格化
严禁使用纯文本描述表单字段，必须使用**表格**形式，包含以下列：
| 字段名称 | 字段类型 | 必填 | 默认值 | 校验规则 | 备注 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| SKU编码 | 文本 | 是 | 无 | 唯一性校验，不支持特殊字符 | 自动转大写 |
| 价格 | 数字 | 是 | 0.00 | > 0，保留2位小数 | |

### 2. 逻辑描述结构化
对于复杂逻辑（如登录认证），建议使用 **“如果...那么...否则...”** 的结构化语言：
*   **场景**：用户点击“发送验证码”
*   **逻辑**：
    1.  **校验**：邮箱格式是否正确？
    2.  **判断**：邮箱是否存在于数据库？
        *   若不存在 -> 提示“邮箱无效，请联系品牌方”。
        *   若存在 -> 检查上一条验证码发送时间是否在 1 分钟内？
            *   是 -> 提示“发送太频繁”。
            *   否 -> 生成 6 位随机码，发送邮件，写入 Redis (有效期5分钟)。

### 3. 界面交互具象化
*   **交互状态定义**：
    *   **Normal (默认)**：按钮可点击，输入框无内容。
    *   **Hover (悬停)**：鼠标移入时的样式变化。
    *   **Active/Focus (激活)**：输入框获得焦点。
    *   **Disabled (禁用)**：置灰不可点（需说明禁用原因，如：未勾选协议）。
    *   **Error (错误)**：校验失败时的红框/提示文案。
    *   **Loading (加载)**：提交中/加载中的转圈状态。
*   **搜索区**：明确支持模糊搜索还是精确匹配。
*   **列表区**：明确默认排序规则（如：按创建时间倒序）。
*   **分页器**：明确默认每页条数（如 10/20/50）。
*   **空状态**：明确无数据时的展示样式（Empty State，包含文案和引导按钮）。

---

## 三、 标准 PRD 模板示例

### {模块名称} 需求说明

#### 1. {功能点名称}
*   **优先级**：P0 (高)
*   **用户角色**：{角色名}
*   **功能描述**：{一句话描述功能}
*   **页面原型**：
    *   [插入原型图或布局描述]
*   **字段定义**：
    | 字段 | 类型 | 规则 | 说明 |
    | :--- | :--- | :--- | :--- |
    | ... | ... | ... | ... |
*   **交互逻辑**：
    1.  进入页面时，默认加载...
    2.  点击【保存】按钮：
        *   前端校验：...
        *   后端校验：...
        *   成功：提示“保存成功”，跳转至列表页。
        *   失败：Toast 提示具体错误原因。
*   **异常处理**：
    *   网络超时：提示“网络连接失败，请重试”。

---

## 四、 AI 生成 Prompt 指引 (For AI Agents)

为了让 AI 能够基于模糊的自然语言需求生成符合本规范的 PRD，请遵循以下 Prompt 结构：

### 1. 角色设定 (Role)
> "你是一位资深的产品经理 (Expert PM)，精通 OpenSpec 规范。你的任务是将用户的自然语言需求转化为结构化、无歧义的 PRD 文档。"

### 2. 思考链 (Chain of Thought)
在生成文档前，请按以下步骤思考：
1.  **识别核心价值**：用户想解决什么问题？(User Story)
2.  **梳理业务闭环**：流程从哪里开始，到哪里结束？(Flowchart)
3.  **拆解功能模块**：需要哪些页面？每个页面有哪些字段？(Functional Req)
4.  **定义边界条件**：异常情况怎么处理？权限怎么控制？(Non-functional Req)

### 3. 生成规则 (Constraints)
*   **强制表格化**：所有字段定义、枚举值、错误码必须使用 Markdown 表格。
*   **具象化交互**：禁止使用“友好的提示”等模糊词汇，必须明确为“弹出 Toast 提示：保存成功”。
*   **技术可行性**：在“后端逻辑”部分，需简要说明数据流向（如：前端 -> API -> DB）。
*   **Gherkin 验收**：每个功能点必须包含至少一条 `Given-When-Then` 格式的验收标准。

### 4. 模板映射 (Template Mapping)
*   用户说："我要一个登录功能" -> 映射为 `功能需求详情` 章节。
*   用户说："密码必须复杂点" -> 映射为 `字段定义` 表格中的 `校验规则` 列 (正则: ^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$) 。
*   用户说："只有管理员能看" -> 映射为 `前置条件` 或 `非功能需求-安全要求`。


