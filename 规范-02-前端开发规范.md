# 网页前端开发规范（网页控制台）

- 适用范围：Vue 3 + Element Plus 的网页控制台（B 端管理后台），用于约束 AI 生成“无偏移”的前端工程结构、页面代码与接口对接。
- 关联文档：
  - [规范-00-全局定义.md](规范-00-全局定义.md)（前端框架/系统环境）
  - [规范-API接口定义.md](规范-API接口定义.md)（接口契约与字段表）
  - [规范-前端后台页面设计.md](规范-前端后台页面设计.md)（布局与组件交互规范）

## 一、强制全局约束（AI 必须遵守）

- **技术栈固定**：
  - Vue：必须 Vue 3
  - UI：必须 Element Plus
  - 语言：必须 TypeScript
  - 构建：必须 Vite
  - 路由：必须 Vue Router
  - 状态：必须 Pinia
- **组件写法固定**：所有页面与组件必须使用 `Composition API` + `<script setup lang="ts">`。
- **数据契约固定**：所有后端响应必须按 `Result<T>` 结构处理；前端禁止自行脑补字段。
- **字段命名固定**：所有 API JSON 字段必须使用 camelCase（与后端规范一致）。
- **权限与登录固定**：
  - Token 必须使用 `Authorization: Bearer <token>` 方式携带。
  - 401/403 必须触发“清理 token + 跳转登录页”。
- **页面类型固定**：每个业务域必须至少提供“列表页 + 新增/编辑表单页 + 详情页”三类页面（若业务不需要详情页，则详情页仍保留为只读展示）。
- **禁止项**：
  - 禁止在 `api/` 内写业务编排逻辑（只允许请求与类型映射）。
  - 禁止在页面内硬编码后端 URL、错误码、字典值（必须集中到 `constants/`）。

## 二、工程目录结构（强制）

```text
project-root
├─ public/
├─ src/
│  ├─ main.ts
│  ├─ App.vue
│  ├─ assets/
│  ├─ styles/
│  │  ├─ index.scss
│  │  ├─ variables.scss
│  │  └─ element-plus.scss
│  ├─ constants/
│  │  ├─ storage.ts
│  │  ├─ route.ts
│  │  └─ dict.ts
│  ├─ types/
│  │  ├─ result.ts
│  │  └─ modules/
│  ├─ utils/
│  ├─ hooks/
│  ├─ directives/
│  ├─ plugins/
│  ├─ router/
│  │  ├─ index.ts
│  │  └─ routes/
│  ├─ store/
│  │  ├─ index.ts
│  │  └─ modules/
│  ├─ api/
│  │  ├─ http/
│  │  │  ├─ client.ts
│  │  │  ├─ interceptors.ts
│  │  │  └─ types.ts
│  │  └─ modules/
│  ├─ layouts/
│  ├─ components/
│  │  ├─ base/
│  │  └─ business/
│  ├─ views/
│  └─ mocks/
├─ tests/
├─ .env.development
├─ .env.production
└─ vite.config.ts
```

## 三、目录职责边界（强制）

- `src/views/`：只存页面；页面私有组件必须放 `src/views/**/components/`，页面私有 hooks 必须放 `src/views/**/hooks/`。
- `src/components/`：只存跨页面复用组件；禁止放页面私有组件。
- `src/api/`：只存“请求函数 + 接口类型”；禁止业务编排、禁止 UI 格式化、禁止写入缓存。
- `src/store/`：只存状态与 action；action 允许调用 `api/`，但禁止直接操作 DOM、禁止写 UI 展示逻辑。
- `src/router/`：只存路由表与守卫；守卫只做鉴权与跳转，不做业务请求。
- `src/constants/`：只存常量/字典/存储 Key；禁止散落硬编码。

## 四、命名规范（固定）

- **目录命名**：统一 kebab-case（如 `user-profile`）。
- **页面目录命名**：统一 kebab-case（如 `views/user/` 或 `views/user-profile/`）。
- **组件文件命名**：统一 PascalCase（如 `UserForm.vue`）。
- **路由 name 命名**：统一 PascalCase 且唯一（如 `UserList`、`UserDetail`、`UserForm`）。
- **API 模块文件**：统一 domain 命名（如 `api/modules/user.ts`、`api/modules/order.ts`）。
- **类型定义文件**：统一 domain 命名（如 `types/modules/user.ts`）。

## 五、路由规范（网页控制台，强制）

- **路由前缀**：控制台所有路由必须以 `/console` 开头。
- **路由结构（固定）**：
  - 列表页：`/console/{domain}`（如 `/console/user`）
  - 详情页：`/console/{domain}/:id`（如 `/console/user/1001`）
  - 表单页：
    - 新增：`/console/{domain}/create`
    - 编辑：`/console/{domain}/:id/edit`
- **route meta（强制字段）**：
  - `meta.title`：菜单与面包屑标题
  - `meta.requiresAuth`：固定为 `true`（登录页除外）
  - `meta.permissions`：权限码数组（无权限控制则为空数组）

## 六、网络请求与 Result<T>（强制）

- `src/types/result.ts` 必须定义：
  - `Result<T>`：包含 `code`、`msg`、`data`
  - `PageResult<T>`：包含 `total`、`list`
- `src/api/http/client.ts` 必须提供统一请求入口：
  - `get/post/put/delete` 返回 `Promise<Result<T>>`
- 拦截器必须实现：
  - 请求：自动注入 `Authorization` header（存在 token 时）
  - 响应：
    - `code` 非成功码时统一抛出异常（由页面统一捕获并提示）
    - 401/403：清理 token 并跳转登录页

## 七、网页控制台页面规范（强制页面骨架）

### 7.1 列表页（固定区块）

- 列表页必须包含以下区块，顺序固定：
  - PageHeader（标题 + 操作按钮区）
  - SearchForm（筛选表单）
  - DataTable（表格）
  - Pagination（分页）
- 列表页必须支持：
  - 重置筛选条件
  - loading 状态
  - 空状态
  - 分页（必须严格按接口契约；若接口契约未定义分页字段，则必须采用“默认分页协议（9.2）”）

### 7.2 表单页（新增/编辑，固定区块）

- 表单页必须包含：
  - PageHeader（返回 + 标题 + 保存/取消）
  - Form（Element Plus 表单，必须有校验规则）
- 表单提交必须：
  - 显示 loading
  - 成功后返回列表页并刷新（或按业务跳转详情页）

### 7.3 详情页（固定区块）

- 详情页必须包含：
  - PageHeader（返回 + 标题 + 编辑/删除）
  - DetailCard（基础信息）
  - Tabs（如有多子模块信息）

## 八、模块生成输入/输出模板（AI 必须按模板执行）

### 8.1 模块输入表格（必须提供）

| 项目 | 值 |
|------|----|
| domain | `user` |
| 中文名 | `用户` |
| 路由前缀 | `/console/user` |
| 权限码 | `[]` |

### 8.2 页面清单表格（必须提供）

| 页面 | 路由 | 组件路径 |
|------|------|----------|
| 列表 | `/console/{domain}` | `src/views/{domain}/list/index.vue` |
| 详情 | `/console/{domain}/:id` | `src/views/{domain}/detail/index.vue` |
| 表单 | `/console/{domain}/create` 与 `/console/{domain}/:id/edit` | `src/views/{domain}/form/index.vue` |

### 8.3 文件清单（必须输出）

- `src/router/routes/{domain}.ts`
- `src/api/modules/{domain}.ts`
- `src/types/modules/{domain}.ts`
- `src/store/modules/{domain}.ts`
- `src/views/{domain}/list/index.vue`
- `src/views/{domain}/detail/index.vue`
- `src/views/{domain}/form/index.vue`

### 8.4 代码生成约束（强制）

- 所有页面必须：
  - 明确声明所用 API 方法与返回类型
  - 明确列定义（表格 columns）与字段映射
  - 不允许出现未在接口契约中定义的字段名

## 九、默认协议与代码模板（用于 AI 无偏移生成）

### 9.1 默认 Result 协议（当接口契约未给出细节时使用）

- 成功码固定为：`SUCCESS_CODE = "200"`
- `Result<T>` 结构固定为：
  - `code: string`
  - `msg: string`
  - `data: T`
- 前端处理规则固定为：
  - `code !== SUCCESS_CODE`：抛出异常并提示 `msg`
  - `code === SUCCESS_CODE`：返回 `data`

### 9.2 默认分页协议（当接口契约未定义分页字段时使用）

- **请求 Query**：
  - `pageNo: number`（固定默认 1）
  - `pageSize: number`（固定默认 20）
- **响应数据**：`PageResult<T>`
  - `total: number`
  - `list: T[]`

### 9.3 基础类型模板（src/types/result.ts）

```ts
export const SUCCESS_CODE = '200'

export interface Result<T> {
  code: string
  msg: string
  data: T
}

export interface PageResult<T> {
  total: number
  list: T[]
}
```

### 9.4 Token 存储模板（src/constants/storage.ts）

```ts
export const ACCESS_TOKEN_KEY = 'accessToken'
```

### 9.5 HTTP 客户端模板（src/api/http/client.ts）

```ts
import axios, { type AxiosInstance, type AxiosRequestConfig } from 'axios'
import { ACCESS_TOKEN_KEY } from '@/constants/storage'
import { SUCCESS_CODE, type Result } from '@/types/result'

function getToken(): string | null {
  return localStorage.getItem(ACCESS_TOKEN_KEY)
}

const instance: AxiosInstance = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL,
  timeout: 15000,
})

instance.interceptors.request.use((config) => {
  const token = getToken()
  if (token) {
    config.headers = config.headers ?? {}
    config.headers.Authorization = `Bearer ${token}`
  }
  return config
})

instance.interceptors.response.use(
  (resp) => {
    const data = resp.data as Result<unknown>
    if (!data || typeof data.code !== 'string') {
      throw new Error('Invalid response')
    }
    if (data.code !== SUCCESS_CODE) {
      throw new Error(data.msg || 'Request failed')
    }
    return resp
  },
  (error) => {
    const status: number | undefined = error?.response?.status
    if (status === 401 || status === 403) {
      localStorage.removeItem(ACCESS_TOKEN_KEY)
      window.location.href = '/login'
    }
    throw error
  },
)

function request<T>(config: AxiosRequestConfig): Promise<Result<T>> {
  return instance.request<Result<T>>(config).then((r) => r.data)
}

export default {
  get<T>(url: string, config?: AxiosRequestConfig): Promise<Result<T>> {
    return request<T>({ ...config, url, method: 'GET' })
  },
  post<T>(url: string, data?: unknown, config?: AxiosRequestConfig): Promise<Result<T>> {
    return request<T>({ ...config, url, data, method: 'POST' })
  },
  put<T>(url: string, data?: unknown, config?: AxiosRequestConfig): Promise<Result<T>> {
    return request<T>({ ...config, url, data, method: 'PUT' })
  },
  delete<T>(url: string, config?: AxiosRequestConfig): Promise<Result<T>> {
    return request<T>({ ...config, url, method: 'DELETE' })
  },
}
```

### 9.6 表格列定义表格（列表页必须先输出）

| 字段 | 标题 | 类型 | 对齐 | 宽度 | 说明 |
|------|------|------|------|------|------|
| id | ID | number | right | 100 | 主键 |
| ... | ... | ... | ... | ... | ... |

### 9.7 路由模块模板（src/router/routes/{domain}.ts）

```ts
import type { RouteRecordRaw } from 'vue-router'

const routes: RouteRecordRaw[] = [
  {
    path: '/console/{domain}',
    name: '{Domain}List',
    component: () => import('@/views/{domain}/list/index.vue'),
    meta: { title: '{中文名}管理', requiresAuth: true, permissions: [] },
  },
  {
    path: '/console/{domain}/create',
    name: '{Domain}Create',
    component: () => import('@/views/{domain}/form/index.vue'),
    meta: { title: '新增{中文名}', requiresAuth: true, permissions: [] },
  },
  {
    path: '/console/{domain}/:id/edit',
    name: '{Domain}Edit',
    component: () => import('@/views/{domain}/form/index.vue'),
    meta: { title: '编辑{中文名}', requiresAuth: true, permissions: [] },
  },
  {
    path: '/console/{domain}/:id',
    name: '{Domain}Detail',
    component: () => import('@/views/{domain}/detail/index.vue'),
    meta: { title: '{中文名}详情', requiresAuth: true, permissions: [] },
  },
]

export default routes
```

### 9.8 类型模块模板（src/types/modules/{domain}.ts）

```ts
export interface {Domain}ListQuery {
  pageNo: number
  pageSize: number
  status?: number
}

export interface {Domain}Entity {
  id: number
  status: number
  createTime: string
  lastModifiedTime: string
}
```

### 9.9 API 模块模板（src/api/modules/{domain}.ts）

```ts
import type { {Domain}Entity, {Domain}ListQuery } from '@/types/modules/{domain}'
import type { PageResult, Result } from '@/types/result'
import http from '@/api/http/client'

export function get{Domain}Page(params: {Domain}ListQuery): Promise<Result<PageResult<{Domain}Entity>>> {
  return http.get('/api/{domain}/page', { params })
}

export function get{Domain}Detail(id: number): Promise<Result<{Domain}Entity>> {
  return http.get(`/api/{domain}/${id}`)
}

export function create{Domain}(data: Record<string, unknown>): Promise<Result<number>> {
  return http.post('/api/{domain}', data)
}

export function update{Domain}(id: number, data: Record<string, unknown>): Promise<Result<void>> {
  return http.put(`/api/{domain}/${id}`, data)
}

export function delete{Domain}(id: number): Promise<Result<void>> {
  return http.delete(`/api/{domain}/${id}`)
}
```

### 9.10 Store 模块模板（src/store/modules/{domain}.ts）

```ts
import { defineStore } from 'pinia'
import type { {Domain}Entity, {Domain}ListQuery } from '@/types/modules/{domain}'
import type { PageResult } from '@/types/result'
import { get{Domain}Page } from '@/api/modules/{domain}'

export const use{Domain}Store = defineStore('{domain}', {
  state: () => ({
    loading: false as boolean,
    query: { pageNo: 1, pageSize: 20 } as {Domain}ListQuery,
    page: { total: 0, list: [] } as PageResult<{Domain}Entity>,
  }),
  actions: {
    async fetchPage() {
      this.loading = true
      try {
        const res = await get{Domain}Page(this.query)
        this.page = res.data
      } finally {
        this.loading = false
      }
    },
  },
})
```

### 9.11 列表页模板（src/views/{domain}/list/index.vue）

```vue
<script setup lang="ts">
import { computed, onMounted } from 'vue'
import { useRouter } from 'vue-router'
import { storeToRefs } from 'pinia'
import { use{Domain}Store } from '@/store/modules/{domain}'

const router = useRouter()
const store = use{Domain}Store()
const { loading, query, page } = storeToRefs(store)

const list = computed(() => page.value.list)
const total = computed(() => page.value.total)

function toCreate() {
  router.push('/console/{domain}/create')
}

function toDetail(id: number) {
  router.push(`/console/{domain}/${id}`)
}

function toEdit(id: number) {
  router.push(`/console/{domain}/${id}/edit`)
}

function onReset() {
  query.value = { pageNo: 1, pageSize: 20 }
  store.fetchPage()
}

onMounted(() => {
  store.fetchPage()
})
</script>

<template>
  <div class="page">
    <el-row justify="space-between" align="middle">
      <el-col>
        <h2>{中文名}管理</h2>
      </el-col>
      <el-col>
        <el-button type="primary" @click="toCreate">新增</el-button>
      </el-col>
    </el-row>

    <el-form :model="query" inline>
      <el-form-item label="状态">
        <el-select v-model="query.status" clearable style="width: 180px">
          <el-option label="启用" :value="1" />
          <el-option label="禁用" :value="0" />
        </el-select>
      </el-form-item>
      <el-form-item>
        <el-button type="primary" @click="store.fetchPage">查询</el-button>
        <el-button @click="onReset">重置</el-button>
      </el-form-item>
    </el-form>

    <el-table :data="list" v-loading="loading">
      <el-table-column prop="id" label="ID" width="100" align="right" />
      <el-table-column prop="status" label="状态" width="100" />
      <el-table-column prop="createTime" label="创建时间" width="180" />
      <el-table-column prop="lastModifiedTime" label="更新时间" width="180" />
      <el-table-column label="操作" width="220">
        <template #default="{ row }">
          <el-button link type="primary" @click="toDetail(row.id)">查看</el-button>
          <el-button link type="primary" @click="toEdit(row.id)">编辑</el-button>
        </template>
      </el-table-column>
    </el-table>

    <el-pagination
      :total="total"
      :page-size="query.pageSize"
      :current-page="query.pageNo"
      layout="total, prev, pager, next, sizes"
      @current-change="(p) => { query.pageNo = p; store.fetchPage() }"
      @size-change="(s) => { query.pageSize = s; query.pageNo = 1; store.fetchPage() }"
    />
  </div>
</template>
<style scoped>
</style>
```

### 9.12 表单页模板（src/views/{domain}/form/index.vue）

```vue
<script setup lang="ts">
import { computed, onMounted, reactive, ref } from 'vue'
import { useRoute, useRouter } from 'vue-router'
import type { FormInstance, FormRules } from 'element-plus'
import { create{Domain}, get{Domain}Detail, update{Domain} } from '@/api/modules/{domain}'

const route = useRoute()
const router = useRouter()

const id = computed(() => (route.params.id ? Number(route.params.id) : null))
const isEdit = computed(() => id.value !== null && route.path.endsWith('/edit'))

const loading = ref(false)
const formRef = ref<FormInstance>()

const formModel = reactive<Record<string, unknown>>({
  status: 1,
})

const rules: FormRules = {
  status: [{ required: true, message: '请选择状态', trigger: 'change' }],
}

async function loadDetail() {
  if (!isEdit.value || id.value === null) return
  loading.value = true
  try {
    const res = await get{Domain}Detail(id.value)
    Object.assign(formModel, res.data)
  } finally {
    loading.value = false
  }
}

async function onSubmit() {
  await formRef.value?.validate()
  loading.value = true
  try {
    if (isEdit.value && id.value !== null) {
      await update{Domain}(id.value, formModel)
    } else {
      await create{Domain}(formModel)
    }
    router.replace('/console/{domain}')
  } finally {
    loading.value = false
  }
}

function onCancel() {
  router.back()
}

onMounted(() => {
  loadDetail()
})
</script>

<template>
  <div class="page" v-loading="loading">
    <el-row justify="space-between" align="middle">
      <el-col>
        <h2>{{ isEdit ? '编辑{中文名}' : '新增{中文名}' }}</h2>
      </el-col>
      <el-col>
        <el-button @click="onCancel">取消</el-button>
        <el-button type="primary" @click="onSubmit">保存</el-button>
      </el-col>
    </el-row>

    <el-form ref="formRef" :model="formModel" :rules="rules" label-width="120px">
      <el-form-item label="状态" prop="status">
        <el-select v-model="formModel.status" style="width: 240px">
          <el-option label="启用" :value="1" />
          <el-option label="禁用" :value="0" />
        </el-select>
      </el-form-item>
    </el-form>
  </div>
</template>

<style scoped>
</style>
```

### 9.13 详情页模板（src/views/{domain}/detail/index.vue）

```vue
<script setup lang="ts">
import { onMounted, ref } from 'vue'
import { useRoute, useRouter } from 'vue-router'
import type { {Domain}Entity } from '@/types/modules/{domain}'
import { get{Domain}Detail } from '@/api/modules/{domain}'

const route = useRoute()
const router = useRouter()
const id = Number(route.params.id)

const loading = ref(false)
const data = ref<{Domain}Entity | null>(null)

async function load() {
  loading.value = true
  try {
    const res = await get{Domain}Detail(id)
    data.value = res.data
  } finally {
    loading.value = false
  }
}

function toEdit() {
  router.push(`/console/{domain}/${id}/edit`)
}

function back() {
  router.back()
}

onMounted(() => {
  load()
})
</script>

<template>
  <div class="page" v-loading="loading">
    <el-row justify="space-between" align="middle">
      <el-col>
        <h2>{中文名}详情</h2>
      </el-col>
      <el-col>
        <el-button @click="back">返回</el-button>
        <el-button type="primary" @click="toEdit">编辑</el-button>
      </el-col>
    </el-row>

    <el-descriptions v-if="data" :column="2" border>
      <el-descriptions-item label="ID">{{ data.id }}</el-descriptions-item>
      <el-descriptions-item label="状态">{{ data.status }}</el-descriptions-item>
      <el-descriptions-item label="创建时间">{{ data.createTime }}</el-descriptions-item>
      <el-descriptions-item label="更新时间">{{ data.lastModifiedTime }}</el-descriptions-item>
    </el-descriptions>
  </div>
</template>

<style scoped>
</style>
```
